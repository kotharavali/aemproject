function func1(){var aNodes=document.getElementsByTagName('a');var leng=aNodes.length;for(var ix=0;ix<leng;ix++){var aNode=aNodes[ix];var p1=aNode.parentNode;var inner=aNode.innerHTML;var dText="";if(typeof(p1)!="undefined"){var p2=p1.parentNode;var outer=p1.innerHTML;if(typeof(p2)!="undefined"){outer=p2.innerHTML}}if(outer.length>0){var pos=outer.indexOf(inner,0);if(pos!=-1){outer=outer.substr(pos+inner.length,2048);pos=outer.search(/<a/i);if(pos!=-1)dText=outer.substr(0,pos);else dText=outer}}self.port.emit('dplink',[aNode.href,aNode.textContent,dText])}var allNodes=document.getElementsByTagName('*');var nleng=allNodes.length;for(ix=0;ix<nleng;ix++){var clkEm=allNodes[ix].onclick;if(clkEm!=null){self.port.emit('dplink',[String(clkEm),allNodes[ix].textContent,"null"])}}}function func2(){var objs=document.getElementsByTagName("embed");var leng=objs.length;for(var ix=0;ix<leng;ix++){self.port.emit('objAds'[objs[ix].src,objs[ix].innerHTML])}var imgs=document.body.getElementsByTagName("img");leng=imgs.length;for(ix=0;ix<leng;ix++){var dest=imgs[ix].parentNode.href;if(dest!=null)self.port.emit('imgAds',[imgs[ix].src,dest])}}function func3(e){var targ;if(!e)e=window.event;if(!e)return;if(e.target)targ=e.target;else if(e.srcElement)targ=e.srcElement;if(!targ)return;var tN=targ.tagName;tN=tN.toLowerCase();if((tN=="b")||(tN=="br")||(tN=="i")||(tN=="u")||(tN=="font")||(tN=="nobr")||(tN=="strong")||(tN=="em")||(tN=="text")||(tN=="div")||(tN=="span")||(tN=="p")||(tN=="h3")){var pNode,clkElem;do{clkElem=targ.onclick;if(clkElem!=null){self.port.emit('dpclk',[tN,String(clkElem),"fake-link"]);return}pNode=targ.parentNode;if(pNode==null)break;tN=(pNode.tagName).toLowerCase();targ=pNode}while(tN=="b"||(tN=="br")||(tN=="i")||(tN=="u")||(tN=="font")||(tN=="nobr")||(tN=="strong")||(tN=="em")||(tN=="text")||(tN=="div")||(tN=="span")||(tN=="p")||(tN=="h3"))}if(tN!="a"&&tN!="img"&&tN!="embed"&&tN!="object"){self.port.emit('dpclk',[tN,"null","null"]);return}if(tN=="embed"){var embSrc=targ.src;if(embSrc!=null){self.port.emit('dpclk',[tN,embSrc,"null"]);return}}if(tN=="object"){var childGroup=targ.childNodes;var clen=childGroup.length;for(var ix=0;ix<clen;ix++){var tn=(childGroup[ix].tagName).toLowerCase();if(tn=="param"){if(childGroup[ix].name=="src"){var pvalue=childGroup[ix].value;if(pvalue!=null){self.port.emit('dpclk',[tN,String(pvalue),"null"]);return}}}else if(tn=="embed"){var tSrc=childGroup[ix].src;if(tSrc!=null){self.port.emit('dpclk',[tN,String(tSrc),"null"]);return}}}var tagData=targ.data;if(tagData!=null){self.port.emit('dpclk',[tN,String(tagData),"null"]);return}}var hrefA=targ.href;if(hrefA!=null){if(hrefA.match("javascript:void")!=null){var pn;var cNode=targ;while(true){pn=cNode.parentNode;if(pn==null)break;tn=pn.tagName.toLowerCase();cNode=pn;if((tn=="p")||(tn=="div")||(tn=="td")||(tn=="tr")||(tn=="tbody")||(tn=="table")){var clkA=pn.onclick;if(clkA!=null){hrefA=String(clkA).toLowerCase();if(hrefA.indexOf("http://")!=0&&hrefA.indexOf("https://")!=0){var pos=hrefA.indexOf("http");if(pos!=-1){hrefA=hrefA.substr(pos)}}break}}else break}}self.port.emit('dpclk',[tN,String(hrefA),targ.text]);return}var srcA=targ.src;if(srcA!=null){self.port.emit('dpclk',[tN,String(srcA),targ.text])}}self.port.emit('pageinfo',[document.URL,document.referrer,unsafeWindow.top==unsafeWindow.self]);document.addEventListener("mouseover",func3,false);func1();func2();self.port.emit('sendData');